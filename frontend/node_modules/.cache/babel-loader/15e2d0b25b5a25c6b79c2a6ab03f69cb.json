{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rphl/Projects/XWordsApp/crosswords/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rphl/Projects/XWordsApp/crosswords/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rphl/Projects/XWordsApp/crosswords/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import useGlobalState from'../utils/useGlobalState';import{useParams}from\"react-router-dom\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var pkg=require('../../package.json');function GridEditor(props){var globalState=useGlobalState();var _useState=useState([10,10]),_useState2=_slicedToArray(_useState,2),dimensions=_useState2[0],setDimensions=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),dimensionsFrozen=_useState4[0],setDimensionsFrozen=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),solutions=_useState6[0],setSolutions=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),selectedBlock=_useState8[0],setSelectedBlock=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),title=_useState10[0],setTitle=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),pub=_useState12[0],setPub=_useState12[1];var _useState13=useState([[],[]]),_useState14=_slicedToArray(_useState13,2),def=_useState14[0],setDef=_useState14[1];var _globalState$user=globalState.user,username=_globalState$user.username,api_token=_globalState$user.api_token;var _useParams=useParams(),gridId=_useParams.uid;var loadGrid=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){var r,d,a,j,i,ch;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(process.env.REACT_APP_API_URL+'/grid/'+id,{method:'GET',credentials:'omit',headers:{'Authorization':'Token '+api_token,'Content-Type':'application/json'}});case 3:r=_context.sent;_context.next=6;return r.json();case 6:d=_context.sent;setDimensions([d.width,d.height]);setTitle(d.title);a=[];for(j=0;j<d.height;j++){a.push([]);for(i=0;i<d.width;i++){ch=d.solution[j*d.width+i];a[j].push(ch==='_'?'':ch.toUpperCase());}}setSolutions(a);setDef(d.definitions);setPub(d.published);setDimensionsFrozen(true);_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);window.location='/';case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,17]]);}));return function loadGrid(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(gridId){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return loadGrid(gridId);case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2);}))();}},[gridId]);var onChangeWidth=function onChangeWidth(ev){setDimensions([ev.target.value,dimensions[1]]);};var onChangeHeight=function onChangeHeight(ev){setDimensions([dimensions[0],ev.target.value]);};var freezeDimensions=function freezeDimensions(){setDimensionsFrozen(true);var arr=[];var arr2=[[],[]];for(var i=0;i<dimensions[1];i++){arr.push([]);arr2[0].push('');for(var j=0;j<dimensions[0];j++){arr[i].push('');}}for(var _j=0;_j<dimensions[0];_j++){arr2[1].push('');}setSolutions(arr);setDef(arr2);};var selectBlock=function selectBlock(i,j){setSelectedBlock([i,j]);};var setSolutionXY=function setSolutionXY(i,j,e){e.preventDefault();var char=e.key.toLowerCase();if(char.length===1&&/[a-z -]/.test(char)){var newSol=solutions;newSol[i][j]=char.toUpperCase();setSolutions(newSol);setSelectedBlock(null);document.activeElement.blur();}if(char==='backspace'){var _newSol=solutions;_newSol[i][j]='';setSolutions(_newSol);setSelectedBlock(null);document.activeElement.blur();}};var setHorizontalDef=function setHorizontalDef(i,txt){var tmp=def;tmp[0][i]=txt;setDef(tmp);};var setVerticalDef=function setVerticalDef(i,txt){var tmp=def;tmp[1][i]=txt;setDef(tmp);};var romanize=function romanize(num){if(isNaN(num))return NaN;var digits=String(+num).split(\"\"),key=[\"\",\"C\",\"CC\",\"CCC\",\"CD\",\"D\",\"DC\",\"DCC\",\"DCCC\",\"CM\",\"\",\"X\",\"XX\",\"XXX\",\"XL\",\"L\",\"LX\",\"LXX\",\"LXXX\",\"XC\",\"\",\"I\",\"II\",\"III\",\"IV\",\"V\",\"VI\",\"VII\",\"VIII\",\"IX\"],roman=\"\",i=3;while(i--){roman=(key[+digits.pop()+i*10]||\"\")+roman;}return Array(+digits.join(\"\")+1).join(\"M\")+roman;};var save=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var url,response,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;url=process.env.REACT_APP_API_URL+'/grid/'+(gridId?gridId:'new');_context3.next=4;return fetch(url,{method:gridId?'PUT':'POST',credentials:'omit',headers:{'Authorization':'Token '+api_token,'Content-Type':'application/json'},body:JSON.stringify({width:dimensions[0],height:dimensions[1],title:title!==''?title:'Grille sans titre',solution:solutions.map(function(l){return l.map(function(c){return c===''?'_':c===' '?'#':c.toLowerCase();}).join('');}).join(''),definitions:def,published:pub?!solutions.map(function(l){return l.map(function(c){return c===''?'_':c===' '?'#':c.toLowerCase();}).join('');}).join('').includes('_'):false})});case 4:response=_context3.sent;if(!(response.status===200||response.status===201)){_context3.next=12;break;}_context3.next=8;return response.json();case 8:res=_context3.sent;window.location=\"/grille/\".concat(res.id,\"/modifier\");_context3.next=13;break;case 12:throw new Error('not ok status');case 13:_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](0);alert('Une erreur est survenue...');case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[0,15]]);}));return function save(){return _ref3.apply(this,arguments);};}();var publish=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(process.env.REACT_APP_API_URL+'/grid/'+gridId,{method:'PUT',credentials:'omit',headers:{'Authorization':'Token '+api_token,'Content-Type':'application/json'},body:JSON.stringify({width:dimensions[0],height:dimensions[1],title:title!==''?title:'Grille sans titre',solution:solutions.map(function(l){return l.map(function(c){return c===' '?'#':c.toLowerCase();}).join('');}).join(''),definitions:def,published:true})});case 2:window.location='/grille/'+gridId;case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function publish(){return _ref4.apply(this,arguments);};}();var deleteG=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return fetch(process.env.REACT_APP_API_URL+'/grid/'+gridId,{method:'DELETE',credentials:'omit',headers:{'Authorization':'Token '+api_token,'Content-Type':'application/json'}});case 2:window.location='/';case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function deleteG(){return _ref5.apply(this,arguments);};}();var isGridFull=function isGridFull(){return solutions.map(function(l){return l.map(function(c){return c;}).join('');}).join('').length===dimensions[0]*dimensions[1];};return/*#__PURE__*/_jsxs(\"div\",{className:\"container main-container\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[gridId?'Editeur de grille':'Nouvelle grille',\" \"]}),!dimensionsFrozen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Dimensions\"}),/*#__PURE__*/_jsx(\"label\",{for:\"width\",children:\"Largeur\"}),/*#__PURE__*/_jsx(\"input\",{name:\"width\",type:\"number\",min:\"1\",onChange:onChangeWidth,defaultValue:dimensions[0]}),/*#__PURE__*/_jsx(\"label\",{for:\"height\",children:\"Hauteur\"}),/*#__PURE__*/_jsx(\"input\",{name:\"height\",type:\"number\",min:\"1\",onChange:onChangeHeight,defaultValue:dimensions[1]}),/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-primary\",onClick:freezeDimensions,children:\"Continuer\"})]}),dimensionsFrozen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Titre: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(e){return setTitle(e.target.Value);},placeholder:\"Titre de la grille\",defaultValue:title}),\" \",pub&&/*#__PURE__*/_jsx(\"span\",{class:\"badge bg-danger\",children:\"publi\\xE9\"}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\" \"}),solutions[0].map(function(val,j){return/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:'center'},children:[romanize(j+1),\".\"]});})]}),solutions.map(function(line,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[i+1,\".\"]}),line.map(function(val,j){return/*#__PURE__*/_jsx(\"td\",{style:{width:'2em',height:'2em',border:'1px solid #000'},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",onFocus:function onFocus(){return selectBlock(i,j);},onBlur:function onBlur(){return selectBlock(null);},style:{outline:'none',textAlign:'center',border:'0',caretColor:'transparent',width:'2em',backgroundColor:selectedBlock&&selectedBlock[0]===i&&selectedBlock[1]===j?'red':val===' '?'black':'white'},onKeyDown:function onKeyDown(e){return setSolutionXY(i,j,e);},readOnly:true,value:solutions[i][j]?val:''})});})]});})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Cliquer sur une case et taper la lettre d\\xE9sir\\xE9, Espace pour noircire la case, Retour arri\\xE8re pour re-initialiser la case.\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'15px'},children:/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-primary save-btn\",onClick:save,children:\"Sauvegarder\"})}),/*#__PURE__*/_jsx(\"h3\",{children:\"D\\xE9finitions\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Horizontalement\"}),/*#__PURE__*/_jsx(\"div\",{children:solutions.map(function(l,i){return/*#__PURE__*/_jsxs(\"div\",{style:{margin:'5px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{width:'3em',display:'inline-block'},children:[i+1,\". \"]}),/*#__PURE__*/_jsx(\"input\",{style:{width:'500px'},type:\"text\",onChange:function onChange(e){return setHorizontalDef(i,e.target.value);},defaultValue:def[0][i]})]});})}),/*#__PURE__*/_jsx(\"h4\",{children:\"Verticalement\"}),/*#__PURE__*/_jsx(\"div\",{children:solutions[0].map(function(l,i){return/*#__PURE__*/_jsxs(\"div\",{style:{margin:'5px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{width:'3em',display:'inline-block'},children:[romanize(i+1),\". \"]}),/*#__PURE__*/_jsx(\"input\",{style:{width:'500px'},type:\"text\",onChange:function onChange(e){return setVerticalDef(i,e.target.value);},defaultValue:def[1][i]})]});})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'15px'},children:/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-primary save-btn\",onClick:save,children:\"Sauvegarder\"})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'15px'},children:/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-danger\",onClick:deleteG,children:\"Supprimer\"})}),isGridFull()&&gridId&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'15px'},children:/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-success\",onClick:publish,children:\"Publier\"})})]})]});}export default GridEditor;","map":{"version":3,"sources":["/Users/rphl/Projects/XWordsApp/crosswords/frontend/src/components/gridEditor.js"],"names":["React","useEffect","useState","useGlobalState","useParams","pkg","require","GridEditor","props","globalState","dimensions","setDimensions","dimensionsFrozen","setDimensionsFrozen","solutions","setSolutions","selectedBlock","setSelectedBlock","title","setTitle","pub","setPub","def","setDef","user","username","api_token","gridId","uid","loadGrid","id","fetch","process","env","REACT_APP_API_URL","method","credentials","headers","r","json","d","width","height","a","j","push","i","ch","solution","toUpperCase","definitions","published","window","location","onChangeWidth","ev","target","value","onChangeHeight","freezeDimensions","arr","arr2","selectBlock","setSolutionXY","e","preventDefault","char","key","toLowerCase","length","test","newSol","document","activeElement","blur","setHorizontalDef","txt","tmp","setVerticalDef","romanize","num","isNaN","NaN","digits","String","split","roman","pop","Array","join","save","url","body","JSON","stringify","map","l","c","includes","response","status","res","Error","alert","publish","deleteG","isGridFull","Value","val","textAlign","line","border","outline","caretColor","backgroundColor","marginTop","margin","display"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport useGlobalState from '../utils/useGlobalState'\nimport { useParams } from \"react-router-dom\";\nconst pkg = require('../../package.json')\n\nfunction GridEditor(props) {\n    const globalState = useGlobalState()\n    const [dimensions, setDimensions] = useState([10, 10])\n    const [dimensionsFrozen, setDimensionsFrozen] = useState(false)\n    const [solutions, setSolutions] = useState([])\n    const [selectedBlock, setSelectedBlock] = useState(null)\n    const [title, setTitle] = useState('')\n    const [pub, setPub] = useState(false)\n    const [def, setDef] = useState([[], []])\n    const { username, api_token } = globalState.user\n    const {uid: gridId} = useParams();\n\n\n    const loadGrid = async (id) => {\n        try {\n            const r = await fetch(process.env.REACT_APP_API_URL+'/grid/'+id, {\n                method: 'GET',\n                credentials: 'omit',\n                headers: {\n                    'Authorization': 'Token ' + api_token,\n                    'Content-Type': 'application/json'\n                }\n            })\n            const d = await r.json()\n            setDimensions([d.width, d.height])\n            setTitle(d.title)\n            const a = []\n            for (let j=0; j< d.height; j++){\n                a.push([])\n                for (let i=0; i< d.width; i++){\n                    const ch = d.solution[j*d.width+i]\n                    a[j].push(ch === '_' ? '': ch.toUpperCase())\n                }\n            }\n            setSolutions(a)\n            setDef(d.definitions)\n            setPub(d.published)\n            setDimensionsFrozen(true)\n        } catch(e) {\n            window.location = '/'\n        }\n    }\n\n    useEffect(()=>{\n        if (gridId) {\n            (async () => (await loadGrid(gridId)))()\n        }\n            \n    }, [gridId])\n\n    const onChangeWidth = (ev) => {\n        setDimensions([ev.target.value, dimensions[1]])\n    }\n\n    const onChangeHeight = (ev) => {\n        setDimensions([dimensions[0], ev.target.value])\n    }\n\n    const freezeDimensions = () => {\n        setDimensionsFrozen(true)\n        \n        const arr = []\n        const arr2 = [[], []]\n        for (let i=0; i < dimensions[1]; i++) {\n            arr.push([])\n            arr2[0].push('')\n            for (let j=0; j < dimensions[0]; j++) {\n                arr[i].push('')\n            }\n        }\n        for (let j=0; j < dimensions[0]; j++) {\n            arr2[1].push('')\n        }\n        setSolutions(arr)\n        setDef(arr2)\n    }\n   \n    const selectBlock = (i, j) => {\n        setSelectedBlock([i, j])\n    }\n\n    const setSolutionXY = (i, j, e) => {\n        e.preventDefault()\n        const char = e.key.toLowerCase()\n        if (char.length === 1 && /[a-z -]/.test(char)){\n            const newSol = solutions;\n            newSol[i][j] = char.toUpperCase()\n            setSolutions(newSol)\n            setSelectedBlock(null);\n            document.activeElement.blur();\n        }\n        if(char === 'backspace'){\n            const newSol = solutions;\n            newSol[i][j] = ''\n            setSolutions(newSol)\n            setSelectedBlock(null);\n            document.activeElement.blur();\n        }\n    }\n\n    const setHorizontalDef = (i, txt) => {\n        const tmp = def\n        tmp[0][i] = txt\n        setDef(tmp)\n    }\n\n    const setVerticalDef = (i, txt) => {\n        const tmp = def\n        tmp[1][i] = txt\n        setDef(tmp)\n    }\n\n    const romanize = (num) => {\n        if (isNaN(num))\n            return NaN;\n        var digits = String(+num).split(\"\"),\n            key = [\"\",\"C\",\"CC\",\"CCC\",\"CD\",\"D\",\"DC\",\"DCC\",\"DCCC\",\"CM\",\n                   \"\",\"X\",\"XX\",\"XXX\",\"XL\",\"L\",\"LX\",\"LXX\",\"LXXX\",\"XC\",\n                   \"\",\"I\",\"II\",\"III\",\"IV\",\"V\",\"VI\",\"VII\",\"VIII\",\"IX\"],\n            roman = \"\",\n            i = 3;\n        while (i--)\n            roman = (key[+digits.pop() + (i * 10)] || \"\") + roman;\n        return Array(+digits.join(\"\") + 1).join(\"M\") + roman;\n    }\n\n    const save = async () => {\n        try {\n            const url = process.env.REACT_APP_API_URL + '/grid/' + (gridId ? gridId : 'new')\n            const response = await fetch(url, {\n                method: gridId ? 'PUT' : 'POST',\n                credentials: 'omit',\n                headers: {\n                    'Authorization': 'Token ' + api_token,\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    width: dimensions[0],\n                    height: dimensions[1],\n                    title: title !== '' ? title : 'Grille sans titre',\n                    solution: solutions.map(l=>l.map(c=> (c==='' ? '_' : (c === ' ' ? '#' : c.toLowerCase()))).join('')).join(''),\n                    definitions: def,\n                    published: pub ? (!solutions.map(l=>l.map(c=> (c==='' ? '_' : (c === ' ' ? '#' : c.toLowerCase()))).join('')).join('').includes('_')) : false\n                })\n            })\n            if (response.status===200 || response.status===201) {\n                const res = await response.json();\n                window.location = `/grille/${res.id}/modifier`\n            } else {\n                throw new Error('not ok status')\n            }\n        } catch (e) {\n            alert('Une erreur est survenue...')\n        }\n    }\n\n    const publish = async () => {\n        await fetch(process.env.REACT_APP_API_URL+'/grid/'+gridId, {\n            method: 'PUT',\n            credentials: 'omit',\n            headers: {\n                'Authorization': 'Token ' + api_token,\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                width: dimensions[0],\n                height: dimensions[1],\n                title: title !== '' ? title : 'Grille sans titre',\n                solution: solutions.map(l=>l.map(c=> (c === ' ' ? '#' : c.toLowerCase())).join('')).join(''),\n                definitions: def,\n                published: true\n            })\n        })\n        window.location = '/grille/' + gridId\n    }\n    const deleteG = async () => {\n        await fetch(process.env.REACT_APP_API_URL+'/grid/'+gridId, {\n            method: 'DELETE',\n            credentials: 'omit',\n            headers: {\n                'Authorization': 'Token ' + api_token,\n                'Content-Type': 'application/json'\n            },\n        })\n        window.location = '/'\n    }\n\n    const isGridFull = () => {\n        return solutions.map(l=>l.map(c=> c).join('')).join('').length === dimensions[0]*dimensions[1]\n    }\n    return (\n        <div className=\"container main-container\">\n            <h1>{gridId ? 'Editeur de grille':'Nouvelle grille'} </h1>\n            \n            {!dimensionsFrozen && (<>\n                <h3>Dimensions</h3>\n                <label for=\"width\">Largeur</label>\n                <input name=\"width\" type=\"number\" min=\"1\" onChange={onChangeWidth} defaultValue={dimensions[0]}></input>\n                <label for=\"height\">Hauteur</label>\n                <input name=\"height\" type=\"number\" min=\"1\" onChange={onChangeHeight} defaultValue={dimensions[1]}></input>\n                <button class=\"btn btn-primary\" onClick={freezeDimensions}>Continuer</button>\n            </>)}\n            {dimensionsFrozen && (<><label>Titre: </label><input type='text' onChange={(e)=>setTitle(e.target.Value)} placeholder=\"Titre de la grille\" defaultValue={title}></input> {pub && <span class=\"badge bg-danger\">publié</span>}<table>\n                <tr><td> </td>{solutions[0].map((val, j)=>(<td style={{textAlign: 'center'}}>{romanize(j+1)}.</td>))}</tr>\n                { solutions.map((line, i)=>(\n                    <tr><td>{i+1}.</td>{line.map((val, j)=>(<td style={{width: '2em', height: '2em', border: '1px solid #000'}}><input type='text' onFocus={() => selectBlock(i, j)} onBlur={() => selectBlock(null)} style={{outline: 'none', textAlign: 'center', border: '0', caretColor: 'transparent', width: '2em', backgroundColor: ((selectedBlock && (selectedBlock[0] === i && selectedBlock[1] === j)) ? 'red' : (val === ' ' ? 'black' : 'white'))}} onKeyDown={(e) => setSolutionXY(i, j, e)} readOnly value={solutions[i][j] ? val : ''}/></td>))}</tr>\n                ))\n                }\n                </table>\n                <p>Cliquer sur une case et taper la lettre désiré, Espace pour noircire la case, Retour arrière pour re-initialiser la case.</p>\n                <div style={{marginTop: '15px'}}>\n                    <button class=\"btn btn-primary save-btn\" onClick={save}>Sauvegarder</button>\n                </div>\n                <h3>Définitions</h3>\n                <h4>Horizontalement</h4>\n                <div>\n                {solutions.map((l, i) => (\n                    <div style={{margin: '5px'}}><span style={{width: '3em', display: 'inline-block'}}>{i+1}. </span><input  style={{width: '500px'}} type=\"text\"  onChange={(e) => setHorizontalDef(i, e.target.value)} defaultValue={def[0][i]}></input></div>\n                ))}\n                </div>\n                <h4>Verticalement</h4>\n                <div>\n                {solutions[0].map((l, i) => (\n                    <div style={{margin: '5px'}}><span style={{width: '3em', display: 'inline-block'}}>{romanize(i+1)}. </span><input style={{width: '500px'}} type=\"text\" onChange={(e) => setVerticalDef(i, e.target.value)} defaultValue={def[1][i]}></input></div>\n                ))}\n                </div>\n                <div style={{marginTop: '15px'}}>\n                    <button class=\"btn btn-primary save-btn\" onClick={save}>Sauvegarder</button>\n                </div>\n                <div style={{marginTop: '15px'}}>\n                    <button class=\"btn btn-danger\" onClick={deleteG}>Supprimer</button>\n                </div>\n                {isGridFull() && gridId && <div style={{marginTop: '15px'}}>\n                    <button class=\"btn btn-success\" onClick={publish}>Publier</button>\n                </div>}\n                </>)\n            }\n        </div>\n    )\n}\n\nexport default GridEditor"]},"metadata":{},"sourceType":"module"}