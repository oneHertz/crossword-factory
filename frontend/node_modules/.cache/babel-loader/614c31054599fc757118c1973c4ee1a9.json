{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rphl/Projects/XWordsApp/crosswords/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rphl/Projects/XWordsApp/crosswords/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rphl/Projects/XWordsApp/crosswords/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import useGlobalState from'../utils/useGlobalState';import{useParams}from\"react-router-dom\";import{useReactToPrint}from'react-to-print';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var pkg=require('../../package.json');function GridEditor(){var globalState=useGlobalState();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),solutions=_useState2[0],setSolutions=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState([[],[]]),_useState6=_slicedToArray(_useState5,2),def=_useState6[0],setDef=_useState6[1];var _globalState$user=globalState.user,username=_globalState$user.username,api_token=_globalState$user.api_token;var _useParams=useParams(),gridId=_useParams.uid;var componentRef=React.useRef();var print=useReactToPrint({content:function content(){return componentRef.current;}});var loadGrid=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){var r,d,a,j,i,ch;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(process.env.REACT_APP_API_URL+'/grid/'+id);case 3:r=_context.sent;_context.next=6;return r.json();case 6:d=_context.sent;setTitle(d.title);a=[];for(j=0;j<d.height;j++){a.push([]);for(i=0;i<d.width;i++){ch=d.grid[j*d.width+i];a[j].push(ch==='_'?'':ch.toUpperCase());}}setSolutions(a);setDef(d.definitions);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);window.location='/';case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));return function loadGrid(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(gridId){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return loadGrid(gridId);case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2);}))();}},[gridId]);var romanize=function romanize(num){if(isNaN(num))return NaN;var digits=String(+num).split(\"\"),key=[\"\",\"C\",\"CC\",\"CCC\",\"CD\",\"D\",\"DC\",\"DCC\",\"DCCC\",\"CM\",\"\",\"X\",\"XX\",\"XXX\",\"XL\",\"L\",\"LX\",\"LXX\",\"LXXX\",\"XC\",\"\",\"I\",\"II\",\"III\",\"IV\",\"V\",\"VI\",\"VII\",\"VIII\",\"IX\"],roman=\"\",i=3;while(i--){roman=(key[+digits.pop()+i*10]||\"\")+roman;}return Array(+digits.join(\"\")+1).join(\"M\")+roman;};return/*#__PURE__*/_jsxs(\"div\",{className:\"container main-container\",children:[!!solutions.length&&/*#__PURE__*/_jsxs(\"div\",{ref:componentRef,style:{margin:'15px'},children:[/*#__PURE__*/_jsx(\"h1\",{children:title}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\" \"}),solutions[0].map(function(val,j){return/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:'center'},children:[romanize(j+1),\".\"]});})]}),solutions.map(function(line,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[i+1,\".\"]}),line.map(function(val,j){return/*#__PURE__*/_jsx(\"td\",{style:{width:'2em',height:'2em',border:'1px solid #000',backgroundColor:val===' '?'black':'white'},children:/*#__PURE__*/_jsx(\"span\",{style:{textAlign:'center'},children:solutions[i][j]?val:''})});})]});})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Cliquer sur une case et taper la lettre d\\xE9sir\\xE9, Retour arri\\xE8re pour re-initialiser la case.\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"D\\xE9finitions\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Horizontalement\"}),/*#__PURE__*/_jsx(\"div\",{children:def[0].map(function(l,i){return/*#__PURE__*/_jsxs(\"div\",{style:{margin:'5px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{width:'3em',display:'inline-block'},children:[i+1,\". \"]}),/*#__PURE__*/_jsx(\"span\",{children:l})]});})}),/*#__PURE__*/_jsx(\"h4\",{children:\"Verticalement\"}),/*#__PURE__*/_jsx(\"div\",{children:def[1].map(function(l,i){return/*#__PURE__*/_jsxs(\"div\",{style:{margin:'5px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{width:'3em',display:'inline-block'},children:[romanize(i+1),\". \"]}),/*#__PURE__*/_jsx(\"span\",{children:l})]});})})]}),/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-primary\",onClick:print,children:\"Imprimer\"})]});}export default GridEditor;","map":{"version":3,"sources":["/Users/rphl/Projects/XWordsApp/crosswords/frontend/src/components/gridViewer.js"],"names":["React","useEffect","useState","useGlobalState","useParams","useReactToPrint","pkg","require","GridEditor","globalState","solutions","setSolutions","title","setTitle","def","setDef","user","username","api_token","gridId","uid","componentRef","useRef","print","content","current","loadGrid","id","fetch","process","env","REACT_APP_API_URL","r","json","d","a","j","height","push","i","width","ch","grid","toUpperCase","definitions","window","location","romanize","num","isNaN","NaN","digits","String","split","key","roman","pop","Array","join","length","margin","map","val","textAlign","line","border","backgroundColor","l","display"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport useGlobalState from '../utils/useGlobalState'\nimport { useParams } from \"react-router-dom\";\nimport { useReactToPrint } from 'react-to-print';\nconst pkg = require('../../package.json')\n\n\nfunction GridEditor() {\n    const globalState = useGlobalState()\n    const [solutions, setSolutions] = useState([])\n    const [title, setTitle] = useState('')\n    const [def, setDef] = useState([[], []])\n    const { username, api_token } = globalState.user\n    const {uid: gridId} = useParams();\n    const componentRef = React.useRef();\n    const print = useReactToPrint({\n      content: () => componentRef.current,\n    });\n\n    const loadGrid = async (id) => {\n        try {\n            const r = await fetch(process.env.REACT_APP_API_URL+'/grid/'+id)\n            const d = await r.json()\n            setTitle(d.title)\n            const a = []\n            for (let j=0; j< d.height; j++){\n                a.push([])\n                for (let i=0; i< d.width; i++){\n                    const ch = d.grid[j*d.width+i]\n                    a[j].push(ch === '_' ? '': ch.toUpperCase())\n                }\n            }\n            setSolutions(a)\n            setDef(d.definitions)\n        } catch(e) {\n            window.location = '/'\n        }\n    }\n\n    useEffect(()=>{\n        if (gridId) {\n            (async () => (await loadGrid(gridId)))()\n        }\n            \n    }, [gridId])\n\n\n    const romanize = (num) => {\n        if (isNaN(num))\n            return NaN;\n        var digits = String(+num).split(\"\"),\n            key = [\"\",\"C\",\"CC\",\"CCC\",\"CD\",\"D\",\"DC\",\"DCC\",\"DCCC\",\"CM\",\n                   \"\",\"X\",\"XX\",\"XXX\",\"XL\",\"L\",\"LX\",\"LXX\",\"LXXX\",\"XC\",\n                   \"\",\"I\",\"II\",\"III\",\"IV\",\"V\",\"VI\",\"VII\",\"VIII\",\"IX\"],\n            roman = \"\",\n            i = 3;\n        while (i--)\n            roman = (key[+digits.pop() + (i * 10)] || \"\") + roman;\n        return Array(+digits.join(\"\") + 1).join(\"M\") + roman;\n    }\n\n    return (\n        <div className=\"container main-container\">\n            { !!solutions.length && (<div ref={componentRef} style={{margin:'15px'}}><h1>{title}</h1><table>\n                <tr><td> </td>{solutions[0].map((val, j)=>(<td style={{textAlign: 'center'}}>{romanize(j+1)}.</td>))}</tr>\n                { solutions.map((line, i)=>(\n                    <tr><td>{i+1}.</td>{line.map((val, j)=>(<td style={{width: '2em', height: '2em', border: '1px solid #000', backgroundColor: (val === ' ' ? 'black' : 'white')}}><span style={{textAlign: 'center'}}>{solutions[i][j] ? val : ''}</span></td>))}</tr>\n                ))\n                }\n                </table>\n                <p>Cliquer sur une case et taper la lettre désiré, Retour arrière pour re-initialiser la case.</p>\n                <h3>Définitions</h3>\n                <h4>Horizontalement</h4>\n                <div>\n                {def[0].map((l, i) => (\n                    <div style={{margin: '5px'}}><span style={{width: '3em', display: 'inline-block'}}>{i+1}. </span><span>{l}</span></div>\n                ))}\n                </div>\n                <h4>Verticalement</h4>\n                <div>\n                {def[1].map((l, i) => (\n                    <div style={{margin: '5px'}}><span style={{width: '3em', display: 'inline-block'}}>{romanize(i+1)}. </span><span>{l}</span></div>\n                ))}\n                </div>\n                </div>)\n            }\n            <button class=\"btn btn-primary\" onClick={print}>Imprimer</button>\n        </div>\n    )\n}\n\nexport default GridEditor"]},"metadata":{},"sourceType":"module"}